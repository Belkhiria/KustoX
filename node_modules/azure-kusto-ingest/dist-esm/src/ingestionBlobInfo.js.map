{"version":3,"file":"ingestionBlobInfo.js","sourceRoot":"","sources":["../../src/ingestionBlobInfo.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT License.\n\nimport { v4 as uuidv4 } from \"uuid\";\nimport { BlobDescriptor } from \"./descriptors.js\";\nimport IngestionProperties, { ReportLevel, ReportMethod } from \"./ingestionProperties.js\";\nimport { IngestionStatusInTableDescription } from \"./ingestionResult.js\";\n\nexport class IngestionBlobInfo {\n    BlobPath: string;\n    RawDataSize: number | null;\n    DatabaseName: string | null;\n    TableName: string | null;\n    RetainBlobOnSuccess: boolean;\n    FlushImmediately: boolean;\n    IgnoreSizeLimit: boolean;\n    ReportLevel: ReportLevel | null;\n    ReportMethod: ReportMethod | null;\n    SourceMessageCreationTime: Date;\n    Id: string;\n    AdditionalProperties: { [additional: string]: any };\n    IngestionStatusInTable: IngestionStatusInTableDescription | null = null;\n    ApplicationForTracing?: string | null = null;\n    ClientVersionForTracing?: string | null = null;\n\n    constructor(\n        blobDescriptor: BlobDescriptor,\n        ingestionProperties: IngestionProperties,\n        authContext: string | null = null,\n        applicationForTracing: string | null = null,\n        clientVersionForTracing: string | null = null,\n    ) {\n        this.BlobPath = blobDescriptor.path;\n        this.RawDataSize = blobDescriptor.size;\n        this.DatabaseName = ingestionProperties.database ?? null;\n        this.TableName = ingestionProperties.table ?? null;\n        this.RetainBlobOnSuccess = true;\n        this.FlushImmediately = ingestionProperties.flushImmediately ?? false;\n        this.IgnoreSizeLimit = false;\n        this.ReportLevel = ingestionProperties.reportLevel ?? null;\n        this.ReportMethod = ingestionProperties.reportMethod ?? null;\n        this.SourceMessageCreationTime = new Date();\n        this.Id = blobDescriptor.sourceId || uuidv4();\n        this.ApplicationForTracing = applicationForTracing;\n        this.ClientVersionForTracing = clientVersionForTracing;\n\n        const additionalProperties = ingestionProperties.additionalProperties || {};\n        additionalProperties.authorizationContext = authContext;\n\n        const tags: string[] = [];\n        if (ingestionProperties.additionalTags) {\n            tags.push(...ingestionProperties.additionalTags);\n        }\n        if (ingestionProperties.dropByTags) {\n            tags.push(...ingestionProperties.dropByTags.map((t) => \"drop-by:\" + t));\n        }\n        if (ingestionProperties.ingestByTags) {\n            tags.push(...ingestionProperties.ingestByTags.map((t) => \"ingest-by:\" + t));\n        }\n\n        if (tags.length > 0) {\n            additionalProperties.tags = JSON.stringify(tags);\n        }\n\n        if (ingestionProperties.ingestIfNotExists) {\n            additionalProperties.ingestIfNotExists = ingestionProperties.ingestIfNotExists;\n        }\n\n        if (ingestionProperties.ingestionMappingColumns && ingestionProperties.ingestionMappingColumns.length > 0) {\n            // server expects a string\n            additionalProperties.ingestionMapping = JSON.stringify(ingestionProperties.ingestionMappingColumns.map((m) => m.toApiMapping()));\n        }\n\n        if (ingestionProperties.ingestionMappingReference) {\n            additionalProperties.ingestionMappingReference = ingestionProperties.ingestionMappingReference;\n        }\n\n        if (ingestionProperties.ingestionMappingKind) {\n            additionalProperties.ingestionMappingType = ingestionProperties.ingestionMappingKind;\n        }\n\n        if (ingestionProperties.validationPolicy) {\n            additionalProperties.ValidationPolicy = ingestionProperties.validationPolicy;\n        }\n\n        if (ingestionProperties.format) {\n            additionalProperties.format = ingestionProperties.format;\n        }\n        if (ingestionProperties.ignoreFirstRecord) {\n            additionalProperties.ignoreFirstRecord = ingestionProperties.ignoreFirstRecord;\n        }\n\n        this.AdditionalProperties = additionalProperties;\n    }\n}\n\nexport default IngestionBlobInfo;\n"]}